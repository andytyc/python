<!--ts-->

- [可变不可变类型](#可变不可变类型)
  - [1. 类型、对象、变量的理解](#1-类型对象变量的理解)
  - [2. 可更改(mutable)与不可更改(immutable)对象](#2-可更改mutable与不可更改immutable对象)
- [函数](#函数)
  - [入门](#入门)
    - [什么是函数](#什么是函数)
    - [怎么自定义函数](#怎么自定义函数)
  - [返回值](#返回值)
    - [无返回值](#无返回值)
    - [返回一个或多个值](#返回一个或多个值)
- [函数的参数](#函数的参数)
  - [1. 传入函数的参数值（传入对象）](#1-传入函数的参数值传入对象)
    - [传不可变对象](#传不可变对象)
    - [传可变对象](#传可变对象)
  - [2. 参数类型](#2-参数类型)
    - [2.1 必需参数](#21-必需参数)
    - [2.2 关键字参数](#22-关键字参数)
    - [2.3 默认参数](#23-默认参数)
      - [2.3.1 默认值不可变对象](#231-默认值不可变对象)
      - [2.3.2 默认参数是否有值传入](#232-默认参数是否有值传入)
    - [2.4 不定长参数](#24-不定长参数)
      - [2.4.1 元组形式](#241-元组形式)
      - [2.4.2 字典形式](#242-字典形式)
      - [2.4.3 特殊形式-只接受关键字参数](#243-特殊形式-只接受关键字参数)

<!-- Added by: edy, at: 2023年 3月14日 星期二 19时38分26秒 CST -->

<!--te-->

# 可变不可变类型

## 1. 类型、对象、变量的理解

在 python 中，类型属于对象，对象有不同类型的区分，变量是没有类型的：

```python
a=[1,2,3]
a="Runoob"
```

以上代码中：

- 对象（值）`[1,2,3]`是 List 类型， 对象 "Runoob" 是 String 类型
- 而变量 a 是没有类型的，她仅仅是一个对象的引用（一个指针），可以是指向 List 类型对象，也可以是指向 String 类型对象。

## 2. 可更改(mutable)与不可更改(immutable)对象

在 python 中，strings, tuples, 和 numbers 是不可更改的对象，而 list,dict 等则是可以修改的对象。

- **不可变类型：**变量赋值 **a=5** 后再赋值 **a=10**，这里实际是新生成一个 int 值对象 10，再让 a 指向它，而 5 被丢弃，不是改变 a 的值，相当于新生成了 a。
- **可变类型：**变量赋值 **la=[1,2,3,4]** 后再赋值 **la[2]=5** 则是将 list la 的第三个元素值更改，本身 la 没有动，只是其内部的一部分值被修改了。

python 函数的参数传递：

- **不可变类型：**类似 C++ 的值传递，如整数、字符串、元组。如 fun(a)，传递的只是 a 的值，没有影响 a 对象本身。如果在 fun(a) 内部修改 a 的值，则是新生成一个 a 的对象。
- **可变类型：**类似 C++ 的引用传递，如 列表，字典。如 fun(la)，则是将 la 真正的传过去，修改后 fun 外部的 la 也会受影响

> python 中一切都是对象，严格意义我们不能说值传递还是引用传递，我们应该说传不可变对象和传可变对象。

# 函数

## 入门

### 什么是函数

函数，其实我们一开始学 Python 的时候就接触过。不过我们使用的大多数都是 Python 的内置函数。比如：基本每个章节都会出现的 `print()` 函数。而现在，我们主要学习的是自定义函数。

各位有没有想过为什么需要函数呢？

- 如果要想回答这个问题，我们需要先了解函数是什么？

函数就是组织好的，可重复使用的，用来实现单一，或相关联功能的代码段。没错，函数其实就是把代码抽象出来的代码段。

- 那为什么要抽象出来呢？

方便我们使用，方便我们重复使用。**函数的本质就是我们把一些数据喂给函数，让他内部消化，然后吐出你想要的东西，至于他怎么消化的，我们不需要知道，它内部解决。**

- 怎么理解这句话呢？

举个例子，好比每次用到的 print 函数，我们都知道这个函数的作用是可以把我们的数据输出到控制台，让我们看到。所以 `print('两点水')` , 我们想打印 `两点水` 出来，就把 `两点水` 这个数据喂给 `print` 函数，然后他就直接把结果打印到控制台上了。

### 怎么自定义函数

怎么自定义函数？

要知道怎么定义函数，就要知道函数的组成部分是怎样的。

```python
def 函数名(参数1，参数2....参数n):
    函数体
    return 语句
```

这就是 Python 函数的组成部分。

所以自定义函数，基本有以下规则步骤：

- 函数代码块以 def 关键词开头，后接函数标识符名称和圆括号()
- 任何传入参数和自变量必须放在圆括号中间。圆括号之间可以用于定义参数
- 函数的第一行语句可以选择性地使用文档字符串（用于存放函数说明）
- 函数内容以冒号起始，并且缩进
- return [表达式] 结束函数，选择性地返回一个值给调用方。不带表达式的 return 相当于返回 None。

语法示例：

```python
def functionname( parameters ):
   "函数_文档字符串"
   function_suite
   return [expression]
```

实例：

1. def 定义一个函数，给定一个函数名 sum
2. 声明两个参数 num1 和 num2
3. 函数的第一行语句进行函数说明：两数之和
4. 最终 return 语句结束函数，并返回两数之和

```python
def sum(num1,num2):
	"两数之和"
	return num1+num2

# 调用函数
print(sum(5,6))
```

输出结果：

```
11
```

## 返回值

return [表达式] 语句用于退出函数，选择性地向调用方返回一个表达式。

### 无返回值

不带参数值的 return 语句返回 `None`

- 不需要写 `return`

```python
#!/usr/bin/python3

# 计算面积函数
def area(width, height):
    return width * height

def print_welcome(name):
    print("Welcome", name)

print_welcome("Runoob")
w = 4
h = 5
print("width =", w, " height =", h, " area =", area(w, h))

# 返回结果
# Welcome Runoob
# width = 4  height = 5  area = 20
```

- 有 `return` 但返回空

```python
#!/usr/bin/python3

def printme(str):
   print (str)
   return

printme(str = "菜鸟教程")

# 以上实例输出结果：
# 菜鸟教程
```

### 返回一个或多个值

- 返回一个值

```python
#!/usr/bin/python3

# 可写函数说明
def sum( arg1, arg2 ):
   # 返回2个参数的和."
   total = arg1 + arg2
   print ("函数内 : ", total)
   return total

# 调用sum函数
total = sum( 10, 20 )
print ("函数外 : ", total)

# 以上实例输出结果：
# 函数内 :  30
# 函数外 :  30
```

- 当然，函数也可以返回多个值，具体实例如下：

```python
# -*- coding: UTF-8 -*-

def  division ( num1, num2 ):
	# 求商与余数
         a = num1 % num2
         b = (num1-a) / num2
         return b , a

num1 , num2 = division(9,4)
tuple1 = division(9,4)

print (num1,num2)
print (tuple1)

# 输出的值：
# 2.0 1
# (2.0, 1)
```

认真观察就可以发现，尽管从第一个输出值来看，返回了多个值，**实际上是先创建了一个元组然后返回的**

# 函数的参数

设置与传递参数是函数的重点，而 Python 的函数对参数的支持非常的灵活。

主要的参数类型有：

默认参数、关键字参数（位置参数）、不定长参数。

## 1. 传入函数的参数值（传入对象）

### 传不可变对象

可以看见在调用函数前后，形参和实参指向的是同一个对象（对象 id 相同），在函数内部修改形参后，形参指向的是不同的 id。

```python
def change(a):
    print("a", id(a))  # 指向的是同一个对象
    a = 10
    print("a [new]", id(a))  # 一个新对象


num = 1
print("num [前", id(num))
change(num)
print("num [后]", id(num))

# num [前 4394172928
# a 4394172928
# a [new] 4394173216
# num [后] 4394172928
```

### 传可变对象

传入函数的和在末尾添加新内容的对象用的是同一个引用。故输出结果如下

```python
def changeme(mylist):
    mylist.append([1, 2, 3, 4])
    print("函数内取值: ", mylist)
    return


onelist = [10, 20, 30]
print("函数外取值 [前]: ", onelist)
changeme(onelist)
print("函数外取值 [后]:", onelist)

# 函数外取值 [前]:  [10, 20, 30]
# 函数内取值:  [10, 20, 30, [1, 2, 3, 4]]
# 函数外取值 [后]: [10, 20, 30, [1, 2, 3, 4]]
```

## 2. 参数类型

以下是调用函数时可使用的正式参数类型：

- 必需参数
- 关键字参数
- 默认参数
- 不定长参数

### 2.1 必需参数

```python
#!/usr/bin/python3

def printme(str):
   print (str)
   return

# 调用 printme 函数，不加参数会报错
printme()
```

### 2.2 关键字参数

**关键字参数和函数调用关系紧密，函数调用使用关键字参数来确定传入的参数值**

使用关键字参数允许函数调用时参数的顺序与声明时不一致，因为 Python 解释器能够用参数名匹配参数值。

> 好处：不必担心参数的顺序，使用函数变得更加简单了。

以下实例在函数 printme() 调用时使用参数名：

```python
#!/usr/bin/python3

def printme(str):
   print (str)
   return

# 调用 printme 函数
printme(str="hello world")
```

以下实例中演示了函数参数的使用不需要使用指定顺序：

```python
#!/usr/bin/python3

def printinfo(name, age):
   print ("名字: ", name)
   print ("年龄: ", age)

#调用printinfo函数
printinfo( age=50, name="runoob" )
```

### 2.3 默认参数

有时候，我们自定义的函数中，如果调用的时候没有设置参数，需要给个默认值，这时候就需要用到默认值参数了。

默认参数，只要在构造函数参数的时候，给参数赋值就可以了

例如：

```python
# -*- coding: UTF-8 -*-

def print_user_info( name , age , sex = '男' ):
    print('昵称：{}'.format(name) , end = ' ')
    print('年龄：{}'.format(age) , end = ' ')
    print('性别：{}'.format(sex))

# 调用 print_user_info 函数
print_user_info( '两点水' , 18 , '女')
print_user_info( '三点水' , 25 )

# 昵称：两点水 年龄：18 性别：女
# 昵称：三点水 年龄：25 性别：男
```

从输出结果可以看到，当你设置了默认参数的时候，在调用函数的时候，不传该参数，就会使用默认值。

但是这里需要注意的一点是：

- **只有在形参表末尾的那些参数可以有默认参数值**，也就是说你不能在声明函数形参的时候，先声明有默认值的形参而后声明没有默认值的形参。

- 这是因为赋给形参的值是根据位置而赋值的。例如，def func(a, b=1) 是有效的，但是 def func(a=1, b) 是 无效 的。

#### 2.3.1 默认值不可变对象

默认值参数就刚才那些技术点吗？这样结束了吗？

还没有的，细想一下，如果参数中是一个可修改的容器比如一个 lsit （列表）或者 dict （字典），那么我们使用什么来作为默认值呢？

我们可以使用 `None` 作为默认值。就像下面这个例子一样：

```python
# 如果 b 是一个 list ，可以使用 None 作为默认值
def print_info( a , b = None ):
    if b is None :
        b=[]
    return
```

认真看下例子，会不会有这样的疑问呢？在参数中我们直接 `b=[]` 不就行了吗？

也就是写成下面这个样子：

```python
def print_info( a , b = [] ):
    return
```

对不对呢？

运行一下也没发现错误啊，可以这样写吗？

这里需要特别注意的一点：

- **默认参数的值是不可变的对象，比如 None、True、False、数字或字符串**，如果你像上面的那样操作，当默认值在其他地方被修改后你将会遇到各种麻烦。

- 这些修改会影响到下次调用这个函数时的默认值。

示例如下：

```python
# -*- coding: UTF-8 -*-

def print_info( a , b = [] ):
    print(b)
    return b ;

result = print_info(1)
result.append('error')
print_info(2)

# []
# ['error']
```

认真观察，**你会发现第二次输出的值根本不是你想要的，因此切忌不能这样操作。**

#### 2.3.2 默认参数是否有值传入

还有一点，有时候我就是不想要默认值啊，只是想单单**判断默认参数有没有值传递进来**，那该怎么办？

我们可以这样做：

```python
_no_value = object()


def print_info(a, b=_no_value):
    if b is _no_value:
        print("b 没有赋值")
    else:
        print("b 赋值了")
    return


if __name__ == "__main__":
    print_info(1)
    print_info(2, 666)

# b 没有赋值
# b 赋值了
```

这里的 `object` 是 python 中所有类的基类。

你可以创建 `object` 类的实例，但是这些实例没什么实际用处，因为它并没有任何有用的方法， 也没有任何实例数据(因为它没有任何的实例字典，你甚至都不能设置任何属性值)。

你唯一能做的就是测试同一性。也正好利用这个特性，来判断是否有值输入。

### 2.4 不定长参数

场景

- 或许有些时候，我们在设计函数的时候，我们有时候无法确定传入的参数个数。那么我们就可以使用不定长参数。

#### 2.4.1 元组形式

Python 提供了一种**元组的方式**来接受没有直接定义的参数。

- 这种方式在参数前边加了星号 `*` 的参数会以元组(tuple)的形式导入，存放所有未命名的变量参数。

```python
#!/usr/bin/python3

def printinfo(arg1, *vartuple):
   print ("输出: ")
   print (arg1)
   print (vartuple)

# 调用printinfo 函数
printinfo( 70, 60, 50 )

# 输出:
# 70
# (60, 50)
```

- 如果在函数调用时没有指定参数（不向函数传递未命名的变量），它就是一个空元组。

```python
def printinfo(arg1, *vartuple):
    print("输出: ")
    print(arg1)
    print(vartuple)
    for var in vartuple:
        print(var)
    return


# 调用printinfo 函数
printinfo(10)
printinfo(70, 60, 50)

# 输出:
# 10
# ()
# 输出:
# 70
# (60, 50)
# 60
# 50
```

#### 2.4.2 字典形式

还有一种就是参数带两个星号 `**` 。

- 加了两个星号 **\*\*** 的参数会以字典的形式导入。

```python
def printinfo2(arg1, **vardict):
    print("输出: ")
    print(arg1)
    print(vardict)


# 调用printinfo2 函数
printinfo2(1, a=2, b=3)
printinfo2(1)

# 输出:
# 1
# {'a': 2, 'b': 3}
# 输出:
# 1
# {}
```

#### 2.4.3 特殊形式-只接受关键字参数

关键字参数使用起来简单，不容易参数出错，那么有些时候，我们定义的函数希望某些参数强制使用关键字参数传递，这时候该怎么办呢？

如果单独出现星号 **\***，则星号 **\*** 后的参数必须用关键字传入，就能达到这种效果。

```python
def f(a, b, *, c):
    return a + b + c

# 报错: TypeError: f() takes 2 positional arguments but 3 were given
# c参数 不使用关键字参数是会报错的
# f(1, 2, 3)

# 成功
res = f(1, 2, c=3)
print(res)

# 6
```

很多情况下，使用强制关键字参数会比使用位置参数表意更加清晰，程序也更加具有可读性。

使用强制关键字参数也会比使用 `**kw` 参数更好且强制关键字参数在一些更高级场合同样也很有用。
